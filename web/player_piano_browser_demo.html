<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html>
<head>
	<title>Player Piano - Browser Edition</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<!-- Date: 2009-03-29 -->
	<!-- Author: Ivan Krozic -->
    <script type="text/javascript" src="jquery-1.2.6.min.js"></script>

	<!-- this is for jQuery / prototype namespace collision avoidance -->
	<script type="text/javascript">
	    jQuery = $;  //rename $ function
	 </script>

	<!-- left trim -->
	<script type="text/javascript" charset="utf-8">
		function ltrim(stringToTrim) {
			return stringToTrim.replace(/^\s+/,"");
		}
	</script>
	
    <script type="text/javascript" src="prototype-1.6.0.3.js"></script>


	<style type="text/css" media="screen">
		pre { background-color: #C4C4C4; min-height: 150px; padding: 15px; }
	</style>
	
	<script type="text/javascript" charset="utf-8">
	
		// enter jQuery no conflict mode in order to 
		jQuery.noConflict();
 
		jQuery(document).ready(function() {	
			
			// SETUP
			var valid_line_starts = [ ">>>", "..."];
			var codeblock = jQuery("#example1").text();
			var lines = codeblock.split("\n");
			for (var i=0; i < lines.length; i++) { lines[i] = ltrim(lines[i]); };
			
			var check_valid_line = function(str) {
				for (var i=0; i < valid_line_starts.length; i++) {
					if ( str.startsWith(valid_line_starts[i]) ) {
						return true;
					}
				}
				return false;
			}
			// END SETUP
			

			// initialize the cursor
			var current_line = 0;
			var index = 0;
			

		    jQuery(document.body).bind('keypress', function(e) {

				var line = lines[current_line];
				var c = line[index];

				if (!check_valid_line(line) ) {
					jQuery("#output1").append("\n");
				}
				
				if ( index <= line.length )  {
					jQuery("#output1").append(c);
					index++;
				} else { 
					//require an "Enter" press
					if (event.keyCode == 13) {
						current_line++;
						index = 0;
						jQuery("#output1").append('\n');
					}
				}

				line = lines[current_line];

				// shortcut for lines that we know are not valid python lines...(result lines)
				if ( !check_valid_line(line) ) {
					jQuery("#output1").append(line);
					jQuery("#output1").append("\n");
					current_line++;
					index = 0;
					return;
				}
			});
			
		});

	</script>


</head>

<body>

<pre id="example1">
>>> print "hello world"
hello world
>>> def adder(x, y):
...     return x + y
>>> add_lambda = lambda y: adder(1, y)
11
</pre>
	
	<pre id="output1">
	</pre>


	</body>
</html>
